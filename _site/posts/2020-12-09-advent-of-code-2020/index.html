<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #d40067; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #d40067; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #6600d4; } /* ControlFlow */
code span.ch { color: #008747; } /* Char */
code span.cn { color: #c15500; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #d40067; } /* DataType */
code span.dv { color: #d40067; } /* DecVal */
code span.er { color: #d40067; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #d40067; } /* Float */
code span.fu { color: #0077ce; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #6600d4; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #6600d4; } /* Other */
code span.pp { color: #d40067; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #008747; } /* SpecialString */
code span.st { color: #008747; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #008747; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>ELLA KAYE: Advent of Code 2020</title>

<meta property="description" itemprop="description" content="My attempts at Advent of Code, 2020"/>

<link rel="canonical" href="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<link rel="icon" type="image/png" href="../../images/favicon.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-12-09"/>
<meta property="article:created" itemprop="dateCreated" content="2020-12-09"/>
<meta name="article:author" content="Ella Kaye"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="ELLA KAYE: Advent of Code 2020"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="My attempts at Advent of Code, 2020"/>
<meta property="og:url" content="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"/>
<meta property="og:image" content="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/advent-of-code-2020.jpg"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="ELLA KAYE"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="ELLA KAYE: Advent of Code 2020"/>
<meta property="twitter:description" content="My attempts at Advent of Code, 2020"/>
<meta property="twitter:url" content="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"/>
<meta property="twitter:image" content="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/advent-of-code-2020.jpg"/>
<meta property="twitter:site" content="@ellamkaye"/>
<meta property="twitter:creator" content="@ellamkaye"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="ELLA KAYE: Advent of Code 2020"/>
<meta name="citation_fulltext_html_url" content="https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2020/12/09"/>
<meta name="citation_publication_date" content="2020/12/09"/>
<meta name="citation_author" content="Ella Kaye"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","preview","twitter","base_url","categories","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["Advent of Code 2020"]},{"type":"character","attributes":{},"value":["My attempts at Advent of Code, 2020"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Ella Kaye"]},{"type":"character","attributes":{},"value":["https://twitter.com/ellamkaye"]}]}]},{"type":"character","attributes":{},"value":["2020-12-09"]},{"type":"character","attributes":{},"value":["advent-of-code-2020.jpg"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["site","creator"]}},"value":[{"type":"character","attributes":{},"value":["@ellamkaye"]},{"type":"character","attributes":{},"value":["@ellamkaye"]}]},{"type":"character","attributes":{},"value":["https://ellakaye.rbind.io/"]},{"type":"character","attributes":{},"value":["R","Advent of Code"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["highlight","self_contained","toc"]}},"value":[{"type":"character","attributes":{},"value":["/Users/ellakaye/ellakaye-distill/ek_syntax_highlighting.theme"]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"]},{"type":"character","attributes":{},"value":["https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["advent-of-code-2020_files/anchor-4.2.2/anchor.min.js","advent-of-code-2020_files/bowser-1.9.3/bowser.min.js","advent-of-code-2020_files/distill-2.2.21/template.v2.js","advent-of-code-2020_files/header-attrs-2.7/header-attrs.js","advent-of-code-2020_files/header-attrs-2.8/header-attrs.js","advent-of-code-2020_files/jquery-1.11.3/jquery.min.js","advent-of-code-2020_files/popper-2.6.0/popper.min.js","advent-of-code-2020_files/tippy-6.2.7/tippy-bundle.umd.min.js","advent-of-code-2020_files/tippy-6.2.7/tippy-light-border.css","advent-of-code-2020_files/tippy-6.2.7/tippy.css","advent-of-code-2020_files/tippy-6.2.7/tippy.umd.min.js","advent-of-code-2020_files/webcomponents-2.0.0/webcomponents.js","advent-of-code-2020.jpg","data/AoC_day1.txt","data/AoC_day10.txt","data/AoC_day11.txt","data/AoC_day2.txt","data/AoC_day3.txt","data/AoC_day4.txt","data/AoC_day5.txt","data/AoC_day6.txt","data/AoC_day7.txt","data/AoC_day8.txt","data/AoC_day9.txt"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`
*/
@import url('https://fonts.googleapis.com/css2?family=Fira+Code');
/* This must remain at the top of this file.                 */


/**
 * @license
 * MyFonts Webfont Build ID 3934149, 2020-08-10T16:13:12-0400
 *
 * The fonts listed in this notice are subject to the End User License
 * Agreement(s) entered into by the website owner. All other parties are
 * explicitly restricted from using the Licensed Webfonts(s).
 *
 * You may obtain a valid license at the URLs below.
 *
 * Webfont: LEMONMILKPro-UltraLight by Marsnev
 * URL: https://www.myfonts.com/fonts/marsnev/lemon-milk-pro/ultra-light/
 *
 * Webfont: LEMONMILKPro-Light by Marsnev
 * URL: https://www.myfonts.com/fonts/marsnev/lemon-milk-pro/light/
 *
 * Webfont: LEMONMILKPro-Regular by Marsnev
 * URL: https://www.myfonts.com/fonts/marsnev/lemon-milk-pro/regular/
 *
 * Webfont: LEMONMILKPro-Medium by Marsnev
 * URL: https://www.myfonts.com/fonts/marsnev/lemon-milk-pro/medium/
 *
 *
 * Webfonts copyright: Copyright © 2020 by MARSNEV. All rights reserved.
 *
 * © 2020 MyFonts Inc
*/


@font-face {
  font-family: 'LEMONMILKPro-Regular';
  src: local('LEMONMILKPro-Regular'), url('/fonts/LEMONMILKPro-Regular.woff2') format('woff2'), url('/fonts/LEMONMILKPro-Regular.woff') format('woff');
}

@font-face {
  font-family: 'LEMONMILKPro-Light';
  src: local('LEMONMILKPro-Light'), url('/fonts/LEMONMILKPro-Light.woff2') format('woff2'), url('/fonts/LEMONMILKPro-Light.woff') format('woff');
}

@font-face {
  font-family: 'LEMONMILKPro-UltraLight';
  src: local('LEMONMILKPro-UltraLight'), url('/fonts/LEMONMILKPro-UltraLight.woff2') format('woff2'), url('/fonts/LEMONMILKPro-UltraLight.woff') format('woff');
}

:root {
  --color-background:   white;
  --color-primary:      #D40067;
  --color-secondary:    #0079D1;
}

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "LEMONMILKPro-Light", sans-serif;
  --mono-font:       "Fira Code", monospace;
  --body-font:       "LEMONMILKPro-UltraLight", sans-serif;
  --navbar-font:     "LEMONMILKPro-Regular", sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       black; /*rgba(255, 255, 255, 0.8);*/
  --text-size:        18px;
  --hover-color:      #D40067; /*white;*/
  --bkgd-color:       white; /*#0F2E3D;*/
}

.distill-site-footer {
  --text-color:       /*rgba(255, 255, 255, 0.8);*/
  --text-size:        15px;
  --hover-color:      #D40067;
  --bkgd-color:       white; /*#0F2E3D;*/
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below */

.distill-site-header {
  text-transform: uppercase;
}

h1, h2, h3 {
  font-family: "LEMONMILKPro-Regular", sans-serif;
  text-transform: uppercase;
}

/*
.btn-outline-dark {
    background-color: #D40067;
    color: white;
    border: 10px;
    border-color: black;
    font-family: "LEMONMILKPro-Regular", sans-serif;
}
*/

/* buttons on postcards homepage page
.btn-outline-dark targets when window is wide
.list-group-item targets when window is narrow
*/
.btn-outline-dark{
   color:#D40067;
   border-color:#D40067;
   font-family: "LEMONMILKPro-Light", sans-serif;
 }

.btn-outline-dark:hover {
    background-color: #D40067;
    border-color:#D40067;
    color: white;
    font-family: "LEMONMILKPro-Light", sans-serif;
    border: none;
}

.list-group-item {
   color:#D40067;
   border-color:#D40067;
   font-family: "LEMONMILKPro-Light", sans-serif;
 }

 .list-group-item:hover {
    background-color: #D40067;
    border-color:#D40067;
    color: white;
    font-family: "LEMONMILKPro-Light", sans-serif;
    border: none;
    text-decoration: none;
 }

/* remove title - logo suffices*/
.distill-site-header .title {
  display: none;
}

.distill-site-header .logo img {
   max-height: 60px;
   width: auto;
   margin-top: 15px;
}

/* styling for icon-link buttons (see distilltools::icon_link()) */
.icon-link {
    background-color: transparent;
    color: #D40067;
    border: 1px solid;
    border-color: #D40067;
    padding: 5px .4rem 5px .4rem;
    /*margin: 4px;*/
    margin-top: 4px;
    margin-right: 8px;
    margin-bottom: 4px;
    border-radius: 5px; /* Rounded edges */
}

.icon-link:hover {
    background-color: #D40067;
    border-color: #D40067;
    color: white;
}

/*
For project cards
Adapted from Ijeamaka Anyene
https://github.com/Ijeamakaanyene/ijeamaka-anyene
https://ijeamaka-anyene.netlify.app
*/

.card {
    color: #474747;
    background-color: #FFFFFF;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    transition: 0.3s;
    border-radius: 10px;
    margin: 16px 16px;
    text-decoration: none;
    display: flex;
}

.card-body {
  padding: 2px 16px;
}

.card-img {
  padding-top: 10px;
  padding-right: 10px;
  padding-bottom: 5px;
  border-radius: 30px;
}

.card-footer {
  background-color: #000;
  color: white;
  text-align: right;
  padding-right: 5px;
}


@media screen and (max-width: 992px) {
  .card {
    color: #474747;
    background-color: #FFFFFF;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    transition: 0.3s;
    border-radius: 10px;
    margin: 16px 16px;
    text-decoration: none;
    display: block;
    width: 300px;
  }

}

/* image on home page - make bigger and squarer*/
.rounded-circle {
  border-radius: 3%!important;
  height: 15rem!important;
}
</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.8/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (!/posts/.test(location.pathname) && !/talks/.test(location.pathname)) {
      return;
    }

    var script = document.createElement("script");
    script.src = "https://utteranc.es/client.js";
    script.setAttribute("repo", "EllaKaye/ellakaye-distill");
    script.setAttribute("issue-term", "title");
    script.setAttribute("crossorigin", "anonymous");
    script.setAttribute("label", "comments");
    script.setAttribute("theme", "github-light");

    /* wait for article to load, append script to article element */
    var observer = new MutationObserver(function (mutations, observer) {
      var article = document.querySelector("d-article");
      if (article) {
        observer.disconnect();
        /* HACK: article scroll */
        article.setAttribute("style", "overflow-y: hidden");
        article.appendChild(script);
      }
    });

    observer.observe(document.body, { childList: true });
  });
</script>

<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-101621242-1"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-101621242-1');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Advent of Code 2020","description":"My attempts at Advent of Code, 2020","authors":[{"author":"Ella Kaye","authorURL":"https://twitter.com/ellamkaye","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-12-09T00:00:00.000+00:00","citationText":"Kaye, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="../../index.html">
<img src="../../images/logo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">ELLA KAYE</a>
</div>
<div class="nav-right">
<a href="../../about.html">About</a>
<a href="../../posts.html">Posts</a>
<a href="../../talks.html">Talks</a>
<a href="../../projects.html">Projects</a>
<a href="https://github.com/EllaKaye/ellakaye-distill">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/ellamkaye">
<i class="fab fa-twitter" aria-hidden="true"></i>
</a>
<a href="../../index.html">
<i class="fas fa-home" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Advent of Code 2020</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../posts.html#category:R" class="dt-tag">R</a>
  <a href="../../posts.html#category:Advent_of_Code" class="dt-tag">Advent of Code</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>My attempts at Advent of Code, 2020</p></p>
</div>

<div class="d-byline">
  Ella Kaye <a href="https://twitter.com/ellamkaye" class="uri">https://twitter.com/ellamkaye</a> 
  
<br/>2020-12-09
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#day-1-report-repair">Day 1: <span>Report Repair</span></a></li>
<li><a href="#day-2-password-philosophy">Day 2: <span>Password Philosophy</span></a></li>
<li><a href="#day-3-toboggan-trajectory">Day 3: <span>Toboggan Trajectory</span></a></li>
<li><a href="#day-4-passport-processing">Day 4: <span>Passport Processing</span></a></li>
<li><a href="#day-5-binary-boarding">Day 5: <span>Binary Boarding</span></a></li>
<li><a href="#day-6-custom-customs">Day 6: <span>Custom Customs</span></a></li>
<li><a href="#day-7-handy-haverstocks">Day 7: <span>Handy Haverstocks</span></a></li>
<li><a href="#day-8-handheld-halting">Day 8: <span>Handheld Halting</span></a></li>
<li><a href="#day-9-encoding-error">Day 9: <span>Encoding Error</span></a></li>
<li><a href="#day-10-adapter-array">Day 10: <span>Adapter Array</span></a></li>
<li><a href="#day-11-seating-system">Day 11: <span>Seating System</span></a></li>
<li><a href="#next">Next</a></li>
</ul>
</nav>
</div>
<p><a href="https://adventofcode.com">Advent of Code</a> is a series of small programming challenges, released daily throughout December in the run-up to Christmas. Part 1 of the challenge is given first. On its successful completion, Part 2 is revealed. The challenges are designed to be solved in any programming language. I will be using R.</p>
<p>There will no doubt be a wide variety of ways to solve these problems. I’m going to go with the first thing I think of that gets the right answer. In most cases, I expect that there will be more concise and efficient solutions. Most of the time I’m working in R, it’s within the <a href="https://www.tidyverse.org">tidyverse</a>, so I imagine that framework will feature heavily below.</p>
<p>Each participant gets different input data, so my numerical solutions may be different from others. If you’re not signed up for Advent of Code yourself, but want to follow along with my data, you can download it at from the data links at the beginning of each day’s section. The links in the day section headers take you to challenge on the Advent of Code page.</p>
<h2 id="day-1-report-repair">Day 1: <a href="https://adventofcode.com/2020/day/1">Report Repair</a></h2>
<p>
<a id='day1'></a>
</p>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day1.txt">My day 1 data</a></p>
<h4 id="part-1-two-numbers">Part 1: Two numbers</h4>
<p>The challenge is to find two numbers from a list that sum to 2020, then to report their product.</p>
<p><code>expand.grid()</code> creates a data frame from all combinations of the supplied vectors. Since the vectors are the same, each pair is duplicated. In this case the two numbers in the list that sum to 2020 are 704 and 1316, and we have one row with 704 as Var1 and one with 704 as Var2. <code>slice(1)</code> takes the first occurrence of the pair.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='va'>expenses</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='st'>"data/AoC_day1.txt"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='va'>expenses</span>, <span class='va'>expenses</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>sum <span class='op'>=</span> <span class='va'>Var1</span> <span class='op'>+</span> <span class='va'>Var2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sum</span> <span class='op'>==</span> <span class='fl'>2020</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>prod <span class='op'>=</span> <span class='va'>Var1</span> <span class='op'>*</span> <span class='va'>Var2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>prod</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 926464</code></pre>
</div>
<h4 id="part-2-three-numbers">Part 2: Three numbers</h4>
<p>The follow-up challenge is the same but with three numbers. I went with essentially the same code but it’s notably slower. There are a lot of repeated calculations here: each triplet appears six times in the table.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='va'>expenses</span>, <span class='va'>expenses</span>, <span class='va'>expenses</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>sum <span class='op'>=</span> <span class='va'>Var1</span> <span class='op'>+</span> <span class='va'>Var2</span> <span class='op'>+</span> <span class='va'>Var3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>sum</span> <span class='op'>==</span> <span class='fl'>2020</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>prod <span class='op'>=</span> <span class='va'>Var1</span> <span class='op'>*</span> <span class='va'>Var2</span> <span class='op'>*</span> <span class='va'>Var3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>prod</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 65656536</code></pre>
</div>
<h2 id="day-2-password-philosophy">Day 2: <a href="https://adventofcode.com/2020/day/2">Password Philosophy</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day2.txt">My day 2 data</a></p>
<h4 id="part-1-number-of-letters">Part 1: Number of letters</h4>
<p>We need to find how many passwords are valid according to their policy. The policies and passwords are given as follows:</p>
<pre><code>1-3 a: abcde
1-3 b: cdefg
2-9 c: ccccccccc</code></pre>
<p>Each line gives the password policy and then the password. The password policy indicates the lowest and highest number of times a given letter must appear for the password to be valid. For example, <code>1-3 a</code> means that the password must contain <code>a</code> at least 1 time and at most 3 times.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>First load the libraries we’ll need. We then read in the data and use <code>tidyr</code> functions to separate out the parts of the policy and the password, making sure to convert the columns to numeric as appropriate:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>passwords</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_tsv</a></span><span class='op'>(</span><span class='st'>"data/AoC_day2.txt"</span>, col_names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>X1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"policy"</span>, <span class='st'>"password"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>":"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>policy</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"count"</span>, <span class='st'>"letter"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>count</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"min"</span>, <span class='st'>"max"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>min</span><span class='op'>)</span>,
         max <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>max</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we use the <code>stringr</code> function <code>str_count()</code> to count how many times the given letter appears in the password, and conditional logic to check whether it is repeated within the specified number of times. Because <code>TRUE</code> has a numeric value of 1 and <code>FALSE</code> has a numeric value of 0, we can sum the resulting column to get a count of how many passwords are valid according to their policies.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>passwords</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_count.html'>str_count</a></span><span class='op'>(</span><span class='va'>password</span>, <span class='va'>letter</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>password_in_policy <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span> <span class='va'>min</span> <span class='op'>&amp;</span> <span class='va'>count</span> <span class='op'>&lt;=</span> <span class='va'>max</span>, <span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>correct <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>password_in_policy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>correct</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 625</code></pre>
</div>
<h4 id="part-2-position-of-letters">Part 2: Position of letters</h4>
<p>Now the policy is interpreted differently. Each policy actually describes two positions in the password, where 1 means the first character, 2 means the second character, and so on. Exactly one of these positions must contain the given letter. How many are valid now?</p>
<p>There were a couple of <em>gotchas</em> here. When I used <code>separate()</code> in the previous part, I had inadvertently left a leading whitespace in front of the password, something that was messing up my indexing with <code>str_sub</code>. Using <code>str_trim()</code> first cleared that up. Also, we need <em>exactly one</em> of the positions to match. <code>|</code> is an inclusive or. We need <code>xor()</code> for exclusive or instead.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>passwords</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>password <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='va'>password</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pos1_letter <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>password</span>, <span class='va'>min</span>, <span class='va'>min</span><span class='op'>)</span>,
         pos2_letter <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>password</span>, <span class='va'>max</span>, <span class='va'>max</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>match_one <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>xor</a></span><span class='op'>(</span><span class='va'>pos1_letter</span> <span class='op'>==</span> <span class='va'>letter</span>, <span class='va'>pos2_letter</span> <span class='op'>==</span> <span class='va'>letter</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>correct <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>match_one</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>correct</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>[1] 391</code></pre>
</div>
<h2 id="day-3-toboggan-trajectory">Day 3: <a href="https://adventofcode.com/2020/day/3">Toboggan Trajectory</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day3.txt">My day 3 data</a></p>
<h4 id="part-1-encountering-trees">Part 1: Encountering trees</h4>
<p>Starting at the top left corner of the map, how many trees (“#”) do we encounter, going at a trajectory of 3 right and 1 down?</p>
<p>First, read in the data and save it into a matrix. My method here feels really hack-y. I’m sure there must be a better approach.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='va'>tree_map</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_tsv</a></span><span class='op'>(</span><span class='st'>"data/AoC_day3.txt"</span>, col_names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>num_col</span> <span class='op'>&lt;-</span> <span class='va'>tree_map</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_length.html'>str_length</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>length</span><span class='op'>)</span>

<span class='va'>tree_vec</span> <span class='op'>&lt;-</span> <span class='va'>tree_map</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>X1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span><span class='op'>(</span><span class='va'>X1</span>, split <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, fixed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>tree_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>tree_vec</span>, ncol <span class='op'>=</span> <span class='va'>num_col</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Now work my way across and down the matrix, using the <code>%%</code> modulo operator to loop round where necessary. The <code>-1</code> and <code>+1</code> in the line <code>((y + right - 1) %% num_col) + 1</code> is a hack to get round the fact that, for <code>num_col</code> columns, the modulo runs from <code>0</code> to <code>num_col - 1</code>, but the column indexes for our matrix run from <code>1</code> to <code>num_col</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>right</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>
<span class='va'>down</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='va'>num_rows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>)</span>
<span class='va'>num_col</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>)</span>

<span class='co'># start counting trees encountered</span>
<span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># start square</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  
<span class='kw'>while</span> <span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;=</span> <span class='va'>num_rows</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='co'># cat("row: ", x, "col: ", y, "\n")</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>[</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span> <span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='va'>trees</span> <span class='op'>+</span> <span class='fl'>1</span>
  
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>down</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>+</span> <span class='va'>right</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%%</span> <span class='va'>num_col</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>
  
<span class='op'>}</span>

<span class='va'>trees</span>
</code></pre>
</div>
<pre><code>[1] 299</code></pre>
</div>
<h4 id="part-2-checking-further-slopes">Part 2: Checking further slopes</h4>
<p>We now need to check several other trajectories, and multiply together the number of trees we find, so we wrap the Part 1 code into a function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>slope_check</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='va'>right</span>, <span class='va'>down</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>num_rows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>)</span>
  <span class='va'>num_col</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>)</span>

  <span class='co'># start counting trees encountered</span>
  <span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

  <span class='co'># start square</span>
  <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
  
  <span class='kw'>while</span> <span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;=</span> <span class='va'>num_rows</span><span class='op'>)</span> <span class='op'>{</span>
  
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>tree_mat</span><span class='op'>[</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span> <span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='va'>trees</span> <span class='op'>+</span> <span class='fl'>1</span>
  
    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>down</span>
    <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>+</span> <span class='va'>right</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%%</span> <span class='va'>num_col</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>
  
  <span class='op'>}</span>
  <span class='va'>trees</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='fu'>slope_check</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,
     <span class='fu'>slope_check</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span>,
     <span class='fu'>slope_check</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>)</span>,
     <span class='fu'>slope_check</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='fl'>7</span>, <span class='fl'>1</span><span class='op'>)</span>,
     <span class='fu'>slope_check</span><span class='op'>(</span><span class='va'>tree_mat</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3621285278</code></pre>
</div>
<h2 id="day-4-passport-processing">Day 4: <a href="https://adventofcode.com/2020/day/4">Passport Processing</a></h2>
<p>
<a id='day4'></a>
</p>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day4.txt">My day 4 data</a></p>
<h4 id="part-1-complete-passports">Part 1: Complete passports</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Using <code>readr::read_tsv()</code> off the bat removes the blank lines, making it impossible to identify the different passports, but reading in the data via <code>readLines()</code> then converting <code>as_tibble()</code> preserves them, and then allows us to use <code>tidyverse</code> functions for the remaining tidying. <code>cumsum()</code> on a logical vectors takes advantage of <code>FALSE</code> having a numeric value of zero and <code>TRUE</code> having a numeric value of one.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>passports</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='st'>"data/AoC_day4.txt"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>value</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>new_passport <span class='op'>=</span> <span class='va'>value</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>new_passport</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>new_passport</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>new_passport</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"key"</span>, <span class='st'>"value"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>":"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/relocate.html'>relocate</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Our data is now in three columns, with ID, key and value, so now we need to find the number of passports with all seven fields once <code>cid</code> is excluded:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>passports</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>key</span> <span class='op'>!=</span> <span class='st'>"cid"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>==</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 210</code></pre>
</div>
<h4 id="part-2-valid-passports">Part 2: Valid passports</h4>
<p>Now we need to add data validation checks:</p>
<ul>
<li>byr (Birth Year) - four digits; at least 1920 and at most 2002.</li>
<li>iyr (Issue Year) - four digits; at least 2010 and at most 2020.</li>
<li>eyr (Expiration Year) - four digits; at least 2020 and at most 2030.</li>
<li>hgt (Height) - a number followed by either cm or in:
<ul>
<li>If cm, the number must be at least 150 and at most 193.</li>
<li>If in, the number must be at least 59 and at most 76.</li>
</ul></li>
<li>hcl (Hair Color) - a # followed by exactly six characters 0-9 or a-f.</li>
<li>ecl (Eye Color) - exactly one of: amb blu brn gry grn hzl oth.</li>
<li>pid (Passport ID) - a nine-digit number, including leading zeroes.</li>
<li>cid (Country ID) - ignored, missing or not.</li>
</ul>
<p>Ignoring the <code>cid</code> field, we narrow down on passports that at least have the right number of fields, and extract the number from the <code>hgt</code> column:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>complete_passports</span> <span class='op'>&lt;-</span> <span class='va'>passports</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>key</span> <span class='op'>!=</span> <span class='st'>"cid"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>add_count</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>==</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>hgt_value <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"hgt"</span> <span class='op'>~</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/parse_number.html'>parse_number</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Then we create a <code>check</code> column, which is <code>TRUE</code> when the value for each key meets the required conditions. Those with 7 <code>TRUE</code>s are valid. Note that with <code>case_when()</code> we’ve left the check column as <code>NA</code> when the condition is <code>FALSE</code>, requiring <code>na.rm = TRUE</code> in the call to <code>sum()</code>. We can get round that by adding a final line to the <code>case_when()</code> condition stating <code>TRUE ~ FALSE</code>. <code>TRUE</code> here is a catch-all for all remaining rows not covered by the conditions above, and then we set them to <code>FALSE</code>, but I find the line <code>TRUE ~ FALSE</code> unintuitive.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>complete_passports</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>check <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
    <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"byr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&gt;=</span> <span class='fl'>1920</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"byr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&lt;=</span> <span class='fl'>2002</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"iyr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&gt;=</span> <span class='fl'>2010</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"iyr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&lt;=</span> <span class='fl'>2020</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"eyr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&gt;=</span> <span class='fl'>2020</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>key</span> <span class='op'>==</span> <span class='st'>"eyr"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>&lt;=</span> <span class='fl'>2030</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"hgt"</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='st'>"cm"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='va'>hgt_value</span> <span class='op'>&gt;=</span> <span class='fl'>150</span> <span class='op'>&amp;</span> <span class='va'>hgt_value</span> <span class='op'>&lt;=</span> <span class='fl'>193</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"hgt"</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='st'>"in"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='va'>hgt_value</span> <span class='op'>&gt;=</span> <span class='fl'>59</span> <span class='op'>&amp;</span> <span class='va'>hgt_value</span> <span class='op'>&lt;=</span> <span class='fl'>76</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,  
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"hcl"</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='st'>"^#[a-f0-9]{6}$"</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"ecl"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"amb"</span>, <span class='st'>"blu"</span>, <span class='st'>"brn"</span>, <span class='st'>"gry"</span>, <span class='st'>"grn"</span>, <span class='st'>"hzl"</span>, <span class='st'>"oth"</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
    <span class='va'>key</span> <span class='op'>==</span> <span class='st'>"pid"</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='st'>"^[0-9]{9}$"</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>TRUE</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>check_all <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>check</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>check_all</span> <span class='op'>==</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 131</code></pre>
</div>
<h2 id="day-5-binary-boarding">Day 5: <a href="https://adventofcode.com/2020/day/5">Binary Boarding</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day5.txt">My day 5 data</a></p>
<h4 id="part-1-finding-all-seat-ids">Part 1: Finding all seat IDs</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The code below sets starts by setting each row number to 127 and each column number to 7, the maximum they can be, then, working along the string, lowering the maximum (or leaving it as is) one letter at a time:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boarding</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_tsv</a></span><span class='op'>(</span><span class='st'>"data/AoC_day5.txt"</span>, col_names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>binary <span class='op'>=</span> <span class='va'>X1</span><span class='op'>)</span>

<span class='va'>seat_IDs</span> <span class='op'>&lt;-</span> <span class='va'>boarding</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fl'>127</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>64</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>32</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>16</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>8</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>4</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>6</span>, <span class='fl'>6</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>2</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>7</span>, <span class='fl'>7</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"F"</span>, <span class='va'>row</span> <span class='op'>-</span> <span class='fl'>1</span>, <span class='va'>row</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>8</span>, <span class='fl'>8</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"L"</span>, <span class='va'>col</span> <span class='op'>-</span> <span class='fl'>4</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>9</span>, <span class='fl'>9</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"L"</span>, <span class='va'>col</span> <span class='op'>-</span> <span class='fl'>2</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_sub.html'>str_sub</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='fl'>10</span>, <span class='fl'>10</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"L"</span>, <span class='va'>col</span> <span class='op'>-</span> <span class='fl'>1</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>row</span> <span class='op'>*</span> <span class='fl'>8</span> <span class='op'>+</span> <span class='va'>col</span><span class='op'>)</span> 

<span class='va'>seat_IDs</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>max <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>max</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 963</code></pre>
</div>
<p>OK, I know I said in the introduction to this post that I would go with the first solution I think of that gets the right answer, and the above does work, but I’m <em>deeply</em> unhappy with the code. There’s too much repetition, I don’t like the use of subtraction when diving by 2 feels more appropriate in a binary context, and it doesn’t feel like I’ve taken full advantage of the mathematical structure of the problem. So, on further reflection, I realise that the way that ID is defined is essentially turning a binary number into a decimal, where we get the binary number as a string by replacing “B” and “R” by “1” and L" and “F” by “0”. Then, I just found, there is a base R function <code>strtoi()</code> that takes a string of digits in a given base and converts it to a base 10 integer, just what we need:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>seat_IDs</span> <span class='op'>&lt;-</span> <span class='va'>boarding</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>binary <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='st'>"L|F"</span>, <span class='st'>"0"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>binary <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_replace.html'>str_replace_all</a></span><span class='op'>(</span><span class='va'>binary</span>, <span class='st'>"B|R"</span>, <span class='st'>"1"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/strtoi.html'>strtoi</a></span><span class='op'>(</span><span class='va'>binary</span>, base <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>seat_IDs</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 963</code></pre>
</div>
<p>That’s better!</p>
<h4 id="part-2-finding-my-seat-id">Part 2: Finding my seat ID</h4>
<p>We need to find the missing number, so we arrange the IDs in ascending order and look at the gap between each ID and the preceding one. In most cases, that should be one. Where we have a gap of 2, we must have skipped the integer below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>seat_IDs</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>diff <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/lead-lag.html'>lag</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>gap <span class='op'>=</span> <span class='va'>ID</span> <span class='op'>-</span> <span class='va'>diff</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>gap</span> <span class='op'>==</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>my_seat <span class='op'>=</span> <span class='va'>ID</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>my_seat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 592</code></pre>
</div>
<h2 id="day-6-custom-customs">Day 6: <a href="https://adventofcode.com/2020/day/6">Custom Customs</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day6.txt">My day 6 data</a></p>
<h4 id="part-1-anyone-answers">Part 1: Anyone answers</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Within each group, we need to find the number of unique letters within each group. We read in and separate the data using the tricks learnt for <a href="#day4">Day 4</a>, and take advantage of the <code>rowwise()</code> feature in <code>dplyr 1.0.0</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>customs_groups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='st'>"data/AoC_day6.txt"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>new_group <span class='op'>=</span> <span class='va'>value</span> <span class='op'>==</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>group_ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>new_group</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>new_group</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>new_group</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_ID</span><span class='op'>)</span> 

<span class='va'>customs_groups</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>qs <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>value</span>, collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>qss <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>qs</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>qsu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>qss</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>qsu</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>total <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>total</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 6585</code></pre>
</div>
<h4 id="part-2-everyone-answers">Part 2: Everyone answers</h4>
<p>Now, instead of unique letters in a group, we need to find the number of letters which appear in all the answers for everyone in the same group. I first note how many people are in each group, then tabulate the number of occurrences of each letter in the group, then count (by summing a logical vector) the number of matches between occurrences of letter and the number in group. Finally, we sum across all groups.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>customs_groups</span> <span class='op'>%&gt;%</span>  
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>add_count</a></span><span class='op'>(</span><span class='va'>group_ID</span>, name <span class='op'>=</span> <span class='st'>"num_in_group"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>group_ID</span>, <span class='va'>num_in_group</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>qs <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_c.html'>str_c</a></span><span class='op'>(</span><span class='va'>value</span>, collapse <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>qss <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>qs</span>, <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>letter_table <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>qss</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>in_common <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>num_in_group</span> <span class='op'>==</span> <span class='va'>letter_table</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>total <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>in_common</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>total</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3276</code></pre>
</div>
<h2 id="day-7-handy-haverstocks">Day 7: <a href="https://adventofcode.com/2020/day/7">Handy Haverstocks</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day7.txt">My day 7 data</a></p>
<h4 id="part-1-number-of-colour-bags">Part 1: Number of colour bags</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We have colour-coded bags that must contain a specific number of other colour-coded bags.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>bags</span> <span class='op'>&lt;-</span> <span class='fu'>read_tsv</span><span class='op'>(</span><span class='st'>"data/AoC_day7.txt"</span>, col_names <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 6 x 1
  X1                                                                  
  &lt;chr&gt;                                                               
1 wavy bronze bags contain 5 striped gold bags, 5 light tomato bags.  
2 drab indigo bags contain 4 pale bronze bags, 2 mirrored lavender ba…
3 pale olive bags contain 3 faded bronze bags, 5 wavy orange bags, 3 …
4 faded white bags contain 5 vibrant violet bags, 4 light teal bags.  
5 mirrored magenta bags contain 2 muted cyan bags, 3 vibrant crimson …
6 dull purple bags contain 1 striped fuchsia bag.                     </code></pre>
</div>
<p>Our first task is to parse the natural language and split the rules into one container/contains pair per line:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rules</span> <span class='op'>&lt;-</span> <span class='va'>bags</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rule <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span><span class='op'>(</span><span class='va'>X1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"container"</span>, <span class='st'>"contains"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" bags contain "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></span><span class='op'>(</span><span class='va'>contains</span>, sep <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>contains <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>contains</span>, <span class='st'>"\\."</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>contains <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>contains</span>, <span class='st'>"bags|bag"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='co'>#mutate(contains = str_replace(contains, "no other", "0 other")) %&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/extract.html'>extract</a></span><span class='op'>(</span><span class='va'>contains</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'number'</span>, <span class='st'>'contains'</span><span class='op'>)</span>, <span class='st'>"(\\d+) (.+)"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>contains <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='va'>contains</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>number <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>number</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<p>To find all bags that con eventually contain our <code>shiny gold</code> bag, we first find the bags that can contain it directly. We then find the bags that can contain those bags and take the union of the two levels. We repeat, stopping when going up a level adds no further bags to the vector of bag colours already found. We then subtract 1, because we don’t want to count the original shiny gold bag.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># function to find all colours that contain a vector of other colours:</span>
<span class='va'>contains_colours</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>colours</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>rules</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>contains</span> <span class='op'>%in%</span> <span class='va'>colours</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>container</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>container</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>bags</span> <span class='op'>&lt;-</span> <span class='st'>"shiny gold"</span>
<span class='va'>old_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span>
<span class='va'>new_length</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># keeping adding to the vector of bags, until no change</span>
<span class='kw'>while</span><span class='op'>(</span><span class='va'>old_length</span> <span class='op'>!=</span> <span class='va'>new_length</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>old_length</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span>
  <span class='va'>bags</span> <span class='op'>&lt;-</span> <span class='fu'>base</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/base/sets.html'>union</a></span><span class='op'>(</span><span class='va'>bags</span>, <span class='fu'>contains_colours</span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='va'>new_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span>
  <span class='co'>#cat(old_length, ", ", new_length, "\n")</span>
<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>bags</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>
</code></pre>
</div>
<pre><code>[1] 274</code></pre>
</div>
<h4 id="part-2-number-of-bags">Part 2: Number of bags</h4>
<p>Now we need to discover the number of bags that a shiny gold bag must contain. I figured that lends itself to recursion, but struggled on the details. Hat tip to David Robinson for <a href="https://twitter.com/drob/status/1336003816395845632">this solution</a>. I’ve learnt a lot for myself by unpicking how it works.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>count_all_contained</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>colour</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>relevant_rules</span> <span class='op'>&lt;-</span> <span class='va'>rules</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>container</span> <span class='op'>%in%</span> <span class='va'>colour</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>relevant_rules</span><span class='op'>$</span><span class='va'>number</span> <span class='op'>*</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'>map_dbl</span><span class='op'>(</span><span class='va'>relevant_rules</span><span class='op'>$</span><span class='va'>contains</span>, <span class='va'>count_all_contained</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  
<span class='op'>}</span>

<span class='fu'>count_all_contained</span><span class='op'>(</span><span class='st'>"shiny gold"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 158730</code></pre>
</div>
<h2 id="day-8-handheld-halting">Day 8: <a href="https://adventofcode.com/2020/day/8">Handheld Halting</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day8.txt">My day 8 data</a></p>
<h4 id="part-1-infinite-loop">Part 1: Infinite Loop</h4>
<p>Our programme gets stuck in an infinite loop. As well as keeping track of the accumulator, we need to keep track of where we’ve visited, and stop when we visit the same instruction twice. We use a <code>data.frame()</code> rather than a <code>tibble()</code> as the former is easier to index into.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instructions</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span><span class='st'>"data/AoC_day8.txt"</span>, col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"instruction"</span>, <span class='st'>"value"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We start with a pretty straight-forward loop, noting that at most it can run for one more than the number of instructions in the programme until it hits an instruction it’s already visited. We update row number to visit next and the accumulator as appropriate.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instructions</span><span class='op'>$</span><span class='va'>visited</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='va'>row</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='va'>num_rows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>)</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='va'>num_rows</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>

  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='kw'>break</span>
  
  <span class='co'># +1 on number of times the row is visited</span>
  <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>1</span>

  <span class='co'># case when the instruction is "acc"</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"acc"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='va'>accumulator</span> <span class='op'>+</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"value"</span><span class='op'>]</span>
    <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>1</span>
  <span class='op'>}</span>
  
  <span class='co'># case when the instruction is "jmp"</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"jmp"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"value"</span><span class='op'>]</span>
  <span class='op'>}</span>

  <span class='co'># case when the instruction is "nop"</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"nop"</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>1</span>
  <span class='op'>}</span>
<span class='op'>}</span>
  
<span class='va'>accumulator</span>
</code></pre>
</div>
<pre><code>[1] 1915</code></pre>
</div>
<h4 id="part-2-fixing-the-programme">Part 2: Fixing the programme</h4>
<p>To break the loop, one of the <code>nop</code> instructions in the programme should be a <code>jmp</code> or vice versa. The plan is to swap these out one by one and check if the programme completes. It’s not a sophisticated approach, but it works fast enough (about a second).</p>
<p>First we note that the broken instruction must be one that we visited in Part 1. Also, an instruction of <code>jmp</code> with a value of 0 will get us stuck in a one-line infinite loop, so we avoid that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='va'>rows_to_check</span> <span class='op'>&lt;-</span> <span class='va'>instructions</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>row_id <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ranking.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>visited</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>instruction</span> <span class='op'>!=</span> <span class='st'>"acc"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>instruction</span> <span class='op'>==</span> <span class='st'>"nop"</span> <span class='op'>&amp;</span> <span class='va'>value</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>row_id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We have 93 instruction to check. We modify our code from Part 1 slightly, converting it into a function and returning a list with values <code>completes</code> and <code>accumulator</code>. <code>completes</code> is <code>FALSE</code> as soon as we visit a row twice and <code>TRUE</code> if the number of our next row to visit is greater than the number of rows in the programme.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>programme_completes</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='fl'>1L</span>
  <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='va'>num_rows</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='va'>num_rows</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>completes <span class='op'>=</span> <span class='cn'>FALSE</span>, accumulator <span class='op'>=</span> <span class='va'>accumulator</span><span class='op'>)</span><span class='op'>)</span> 
    <span class='op'>}</span>
    
    <span class='co'># +1 on number of times the row is visited</span>
    <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"visited"</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>1</span>
  
    <span class='co'># case when the instruction is "acc"</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"acc"</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>accumulator</span> <span class='op'>&lt;-</span> <span class='va'>accumulator</span> <span class='op'>+</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"value"</span><span class='op'>]</span>
      <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='op'>}</span>
  
    <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"jmp"</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"value"</span><span class='op'>]</span>
    <span class='op'>}</span>
  
    <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='st'>"instruction"</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"nop"</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>row</span> <span class='op'>&lt;-</span> <span class='va'>row</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='op'>}</span>
  
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>row</span> <span class='op'>&gt;</span> <span class='va'>num_rows</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>completes <span class='op'>=</span> <span class='cn'>TRUE</span>, accumulator <span class='op'>=</span> <span class='va'>accumulator</span><span class='op'>)</span><span class='op'>)</span> 
    <span class='op'>}</span>
  <span class='op'>}</span>
<span class='op'>}</span>  
</code></pre>
</div>
</div>
<p>We now loop over the rows we’ve identified to check, breaking the loop as soon as we find a programme that completes. Finally, we extract the accumulator value from the successful programme.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>instructions</span><span class='op'>$</span><span class='va'>visited</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='kw'>for</span> <span class='op'>(</span><span class='va'>row</span> <span class='kw'>in</span> <span class='va'>rows_to_check</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='co'># modify one row of the instructions,</span>
  <span class='co'># copying data frame so we don't have to modify it back</span>
  <span class='va'>modified_instructions</span> <span class='op'>&lt;-</span> <span class='va'>instructions</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"jmp"</span>, 
         <span class='va'>modified_instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"nop"</span>, 
         <span class='va'>modified_instructions</span><span class='op'>[</span><span class='va'>row</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"jmp"</span><span class='op'>)</span> 
  
  <span class='co'># check if the modified programme completes</span>
  <span class='va'>check_programme</span> <span class='op'>&lt;-</span> <span class='fu'>programme_completes</span><span class='op'>(</span><span class='va'>modified_instructions</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>check_programme</span><span class='op'>$</span><span class='va'>completes</span><span class='op'>)</span> 
    <span class='kw'>break</span>
<span class='op'>}</span>

<span class='va'>check_programme</span><span class='op'>$</span><span class='va'>accumulator</span>
</code></pre>
</div>
<pre><code>[1] 944</code></pre>
</div>
<h2 id="day-9-encoding-error">Day 9: <a href="https://adventofcode.com/2020/day/9">Encoding Error</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day9.txt">My day 9 data</a></p>
<h4 id="part-1-weak-link">Part 1: Weak Link</h4>
<p>We have to find the first number in the list which is <em>not</em> the sum of a pair of different numbers in the preceding 25 numbers.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>input</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='st'>"data/AoC_day9.txt"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<p>There’s a nice trick for finding the pair of numbers in a vector that sum to a target that was doing the rounds on twitter in response to the <a href="#day1">Day 1</a> challenge: <code>intersect(input, 2020 - input)</code>. For this challenge, we expand on that idea, writing it as a <code>check_sum</code> function. Where there’s more than one pair, it won’t say which pair together, and if the number that’s half the target appears in the addends, it will only appear once in the output. However, for this challenge, we only need to know when there are <em>no</em> pairs that sum to the target, which will be the case when the length of the output of <code>check_sum</code> is 0.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>check_sum</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>target</span>, <span class='va'>addends</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://generics.r-lib.org/reference/setops.html'>intersect</a></span><span class='op'>(</span><span class='va'>addends</span>, <span class='va'>target</span><span class='op'>-</span><span class='va'>addends</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Then, it’s simply a case of iterating over windows of length 25, checking whether the following number is the sum of a distinct pair in that window, and returning the first one that isn’t.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>find_invalid_num</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>vec</span>, <span class='va'>win</span> <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>win</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>vec</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>check</span> <span class='op'>&lt;-</span> <span class='fu'>check_sum</span><span class='op'>(</span><span class='va'>vec</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>, <span class='va'>vec</span><span class='op'>[</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='va'>win</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
    
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>check</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>vec</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  
<span class='op'>}</span>

<span class='fu'>find_invalid_num</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 507622668</code></pre>
</div>
<h4 id="part-2-contiguous-set">Part 2: Contiguous set</h4>
<p>Find a contiguous set in the list that sums to the invalid number from Part 1, and add together the largest and smallest number in that range.</p>
<p>First, we note that after a certain point, all numbers in the input are larger than the target, so we don’t need to consider those. We reduce our input vector accordingly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>target</span> <span class='op'>&lt;-</span> <span class='fu'>find_invalid_num</span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span>

<span class='va'>input_reduced</span> <span class='op'>&lt;-</span> <span class='va'>input</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>input</span> <span class='op'>&lt;=</span> <span class='va'>target</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<p>To find the contiguous set in the list that sums to the target, we make use of <code>accumulate()</code> from the <code>purrr</code> package. Let the input list be <span class="math inline">\(x = (x_1, x_2,..., x_n)\)</span>. Then <code>accumulate(x, sum)</code> returns <span class="math inline">\(a = (x_1, x_1 + x_2,..., \sum_{j=1}^n x_j)\)</span>. We check whether any element of this vector is equal to the target. If so we index into the input vector appropriately, sum the min and max in the range and we’re done. If not, we consider the sums of all windows starting with the second element of the input list, and so on.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>contiguous_sum</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>input</span>, <span class='va'>target</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>len</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>input</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>len</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/accumulate.html'>accumulate</a></span><span class='op'>(</span><span class='va'>input</span><span class='op'>[</span><span class='va'>i</span><span class='op'>:</span><span class='va'>len</span><span class='op'>]</span>, <span class='va'>sum</span><span class='op'>)</span>
    <span class='va'>b</span> <span class='op'>&lt;-</span> <span class='va'>a</span> <span class='op'>==</span> <span class='va'>target</span>
    
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='va'>output_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>b</span><span class='op'>)</span>
      
      <span class='va'>contiguous_set</span> <span class='op'>&lt;-</span> <span class='va'>input</span><span class='op'>[</span><span class='va'>i</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span> <span class='op'>+</span> <span class='va'>output_length</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>
      
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>contiguous_set</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='fu'>contiguous_sum</span><span class='op'>(</span><span class='va'>input_reduced</span>, <span class='va'>target</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 76688505</code></pre>
</div>
<p>I appreciate that there’s some redundant calculation in this method. The vectors of accumulated sums can contain numbers larger than the target (if writing our own loop, we could break as soon as the accumulated sum got too big). Also, in retrospect, we could have only run <code>accumulate</code> once, then in the second iteration of the loop, subtracted <code>input[1]</code> from the result, in the third iteration subtracted <code>input[2]</code> from that result, etc. However, the function as written is concise and easy to understand, and gets our answer in around a second, so that will do!</p>
<h2 id="day-10-adapter-array">Day 10: <a href="https://adventofcode.com/2020/day/10">Adapter Array</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day10.txt">My day 10 data</a></p>
<h4 id="part-1-adapter-distribution">Part 1: Adapter Distribution</h4>
<p>This is simply a case of ordering the adapters, prepending 0 and appending the the max in the list plus three, then finding the differences.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>adapters</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span><span class='op'>(</span><span class='st'>"data/AoC_day10.txt"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>adapter_diffs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>adapters</span>, <span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>adapters</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>adapter_diffs</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>adapter_diffs</span> <span class='op'>==</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 3034</code></pre>
</div>
<h4 id="part-2-adapter-combinations">Part 2: Adapter combinations</h4>
<p>Instead of building up sequences of adapters, we see what we can remove from the full list.</p>
<p>First, we check the diffs: are they just 1 and 3 or are there any 2s?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>adapter_diffs</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>adapter_diffs
 1  3 
74 41 </code></pre>
</div>
<p>We can’t remove an adapter if its difference with the previous adapter is 3, otherwise the difference between the adapters on either side of it will be too big.</p>
<p>What about diffs of 1? It depends how many ones there are around it. We can check this using the <code>rle()</code> (run length encoding) function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>runs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rle.html'>rle</a></span><span class='op'>(</span><span class='va'>adapter_diffs</span><span class='op'>)</span>
<span class='va'>runs</span>
</code></pre>
</div>
<pre><code>Run Length Encoding
  lengths: int [1:48] 3 2 4 2 4 2 4 1 4 2 ...
  values : num [1:48] 1 3 1 3 1 3 1 3 1 3 ...</code></pre>
</div>
<p>What is the distribution of lengths of sequences of 1s?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>runs_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>runs</span><span class='op'>$</span><span class='va'>lengths</span><span class='op'>)</span> 
<span class='va'>runs_table</span>
</code></pre>
</div>
<pre><code>
 1  2  3  4 
13 14 10 11 </code></pre>
</div>
<p>We have at most four diffs of 1 in a row.</p>
<p>We need to check that if we remove an adapter, the new differences do not exceed 3. Example sequences really helped me figure out what’s going on here:</p>
<ul>
<li>If the diff sequence is …, 3, 1, 3,… (e.g. adapters 1, 4, 5, 8)
<ul>
<li>1 option to keep as is</li>
<li>We cannot remove any adapters</li>
<li><strong>1 option in total</strong></li>
</ul></li>
<li>If the diff sequence is …, 3, 1, 1, 3,… (e.g. adapters 1, 4, 5, 6, 9)
<ul>
<li>1 option to keep as is</li>
<li>1 option to remove one adapter (e.g. the 5)</li>
<li>we cannot remove two adapters</li>
<li><strong>2 options total</strong></li>
</ul></li>
<li>If the diff sequence is …, 3, 1, 1, 1, 3,… (e.g. adapters 1, 4, 5, 6, 7, 10)
<ul>
<li>1 option to keep as is</li>
<li>2 options to remove one adapter (e.g. the 5 or 6)</li>
<li>1 options to remove two adapters (e.g. the 5 and 6)</li>
<li>We cannot remove three adapters</li>
<li><strong>4 options total</strong></li>
</ul></li>
<li>If the diff sequence is …, 3, 1, 1, 1, 1, 3,… (e.g. adapters 1, 4, 5, 6, 7, 8, 11)
<ul>
<li>1 option to keep as is</li>
<li>3 options to remove one adapter (e.g. 5, 6, or 7)</li>
<li>3 options to remove two adapters (e.g. any two of 5, 6, and 7)</li>
<li>We cannot remove three adapters</li>
<li><strong>7 options total</strong></li>
</ul></li>
</ul>
<p>Finally, we multiply each run length of difference of 1s with the number of options we have for removing adapters, then take the product of those products.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>runs_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>lengths <span class='op'>=</span> <span class='va'>runs</span><span class='op'>$</span><span class='va'>lengths</span>, values <span class='op'>=</span> <span class='va'>runs</span><span class='op'>$</span><span class='va'>values</span><span class='op'>)</span>

<span class='va'>options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>lengths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span>, options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>runs_df</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>values</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>options</span>, by <span class='op'>=</span> <span class='st'>"lengths"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>prod_options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='va'>options</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>prod_options</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span>scientific <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>[1] &quot;259172170858496&quot;</code></pre>
</div>
<h2 id="day-11-seating-system">Day 11: <a href="https://adventofcode.com/2020/day/11">Seating System</a></h2>
<p><a href="https://ellakaye.rbind.io/post/advent-of-code-2020/data/AoC_day11.txt">My day 11 data</a></p>
<h4 id="part-1-changing-layout">Part 1: Changing layout</h4>
<p>My code for Day 11 runs a little slow (about 10 seconds for Part 1 and 80 seconds for Part 2), so for the sake of being able to rebuild this page quickly as I keep updating it working through the challenges, I will demonstrate this code with the test input provided as an example.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>First we read in the data and convert it to a matrix (using the <a href="https://github.com/MilesMcBain/datapasta"><code>datapasta</code></a> package for the test input):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># layout &lt;- readr::read_tsv("data/AoC_day11.txt", col_names = FALSE)</span>

<span class='va'>layout</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>X1</span>,
  <span class='st'>"L.LL.LL.LL"</span>,
  <span class='st'>"LLLLLLL.LL"</span>,
  <span class='st'>"L.L.L..L.."</span>,
  <span class='st'>"LLLL.LL.LL"</span>,
  <span class='st'>"L.LL.LL.LL"</span>,
  <span class='st'>"L.LLLLL.LL"</span>,
  <span class='st'>"..L.L....."</span>,
  <span class='st'>"LLLLLLLLLL"</span>,
  <span class='st'>"L.LLLLLL.L"</span>,
  <span class='st'>"L.LLLLL.LL"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># get number of columns for matrix</span>
<span class='va'>num_col</span> <span class='op'>&lt;-</span> <span class='va'>layout</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_length.html'>str_length</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>length</span><span class='op'>)</span>

<span class='co'># split layout into characters and turn to vector</span>
<span class='va'>layout_vec</span> <span class='op'>&lt;-</span> <span class='va'>layout</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>X1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span><span class='op'>(</span><span class='va'>X1</span>, split <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, fixed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># organise into matrix</span>
<span class='va'>initial_layout</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>layout_vec</span>, ncol <span class='op'>=</span> <span class='va'>num_col</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we write a helper function that, given a matrix and row and column indices, returns a vector of the adjacent seats. We need to take care when indexing into the matrix, so we treat all corner and edge cases separately. Fiddly, but gets the job done.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_adj</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>nr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>
  <span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>
  
  <span class='co'># corner cases</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>(</span><span class='va'>nc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='fl'>2</span>,<span class='op'>(</span><span class='va'>nc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>nc</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span> <span class='op'>&amp;</span> <span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span> <span class='op'>&amp;</span> <span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>(</span><span class='va'>nc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>nc</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span>, <span class='va'>nc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>  
  
  <span class='co'># edge cases</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span>,<span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span>,<span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='va'>nr</span><span class='op'>-</span><span class='fl'>1</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span>, <span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span>, <span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>, <span class='va'>nc</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>, <span class='va'>nc</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  
  <span class='co'># inside cases</span>
  <span class='kw'>else</span> <span class='op'>{</span><span class='va'>adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span>,<span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>, <span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span>,<span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>}</span>
  
  <span class='va'>adj</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Once we have a vector of surrounding seats, we can apply the rules in the problem to determine whether a given seat needs to change state. The <code>needs_changing</code> helper function does that. It’s overkill at this point to give options to specify the function for finding the vector of seats to check, and the maximum number of occupied seats people can tolerate around them, but (spolier alert) I put in these options when working on the challenge in Part 2.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>needs_changing</span> <span class='op'>&lt;-</span> 
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>i</span>,<span class='va'>j</span>, <span class='va'>get_surround</span> <span class='op'>=</span> <span class='va'>get_adj</span>, <span class='va'>max_occupied</span> <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>surround</span> <span class='op'>&lt;-</span> <span class='fu'>get_surround</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span>
  <span class='va'>n_occupied</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>surround</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"L"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>n_occupied</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>TRUE</span><span class='op'>)</span>
  
  <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>]</span> <span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>n_occupied</span> <span class='op'>&gt;=</span> <span class='va'>max_occupied</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>TRUE</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='kw'>else</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Since floor spaces don’t change, we only need to consider seats. We save the indices of the seats into a data frame, so we can vectorise over it using <code>tidyverse</code> functions. However, when we’ve determined the seats that need changing, using our <code>needs_changing</code> function, we need to convert those indices from a data.frame into a matrix, in order to index into the layout matrix appropriately and make the changes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>seats</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>initial_layout</span> <span class='op'>!=</span> <span class='st'>"."</span>, arr.ind <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>seats_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>seats</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>i <span class='op'>=</span> <span class='va'>row</span>, 
         j <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>layout</span> <span class='op'>&lt;-</span> <span class='va'>initial_layout</span>
<span class='va'>iters</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># loop until there are no further changes</span>
<span class='kw'>repeat</span> <span class='op'>{</span>
  
  <span class='va'>change</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='va'>seats_to_change</span> <span class='op'>&lt;-</span> 
    <span class='va'>seats_df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>change_seat <span class='op'>=</span> <span class='fu'>needs_changing</span><span class='op'>(</span><span class='va'>layout</span>,<span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span><span class='op'>)</span>   
  
  <span class='va'>change</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>seats_to_change</span><span class='op'>$</span><span class='va'>change_seat</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>change</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='kw'>break</span>
  
  <span class='va'>indices_to_change</span> <span class='op'>&lt;-</span> 
    <span class='va'>seats_to_change</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>change_seat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>  

  <span class='va'>layout</span><span class='op'>[</span><span class='va'>indices_to_change</span><span class='op'>]</span> <span class='op'>&lt;-</span> 
    <span class='fu'><a href='https://generics.r-lib.org/reference/setops.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"L"</span>, <span class='st'>"#"</span><span class='op'>)</span>,  <span class='va'>layout</span><span class='op'>[</span><span class='va'>indices_to_change</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>iters</span> <span class='op'>&lt;-</span> <span class='va'>iters</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='op'>}</span>

<span class='va'>part_1_iters</span> <span class='op'>&lt;-</span> <span class='va'>iters</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>layout</span><span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 37</code></pre>
</div>
<p>On the test set, this takes 5 iterations. On the full data set, my answer is 2316, and it took 107 iterations.</p>
<h4 id="part-2-looking-further">Part 2: Looking further</h4>
<p>Now, people look to the first seat they can see in each direction, and will change from occupied to unoccupied if five or more of them are occupied.</p>
<p>The plan is to write a function that extracts full vectors from a given seat to the edge of the layout matrix in each of the eight directions, then finds the first seat in each of those directions, and finally collects those into a vector of the seats under consideration when determining if a change is needed. Then I can reuse the loop from Part 1, just changing the arguments in the calls to <code>needs_changing</code>.</p>
<p>Here’s a helper function to get the first seat in a vector looking in one direction:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>get_first_seat_from_vec</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>vec</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>vec</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#"</span>, <span class='st'>"L"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>vec</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>vec</span> <span class='op'>!=</span> <span class='st'>"."</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now, if I thought getting adjacent seats to a given seat in Part 1 was fiddly, it’s nothing on getting a vector from a given seat to the edge of the matrix. There are many cases to consider to make we we don’t go out of bounds. In the diagonal directions, first we get a matrix of the indices of the matrix we need, then subset into the matrix accordingly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># takes a layout matrix (elements ".", "#", "L")</span>
<span class='co'># returns vector with first "L" or "#" encountered in each direction</span>
<span class='va'>get_first_seat</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>mat</span>, <span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>nr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>
  <span class='va'>nc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span>
  
  <span class='co'># North</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>N</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>N</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span>,<span class='va'>j</span><span class='op'>]</span>
  
  <span class='co'># South</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span><span class='op'>)</span> <span class='va'>S</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>&lt;</span> <span class='va'>nr</span><span class='op'>)</span> <span class='va'>S</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>nr</span>,<span class='va'>j</span><span class='op'>]</span>
  
  <span class='co'># East</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='va'>E</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>&lt;</span> <span class='va'>nc</span><span class='op'>)</span> <span class='va'>E</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='va'>nc</span><span class='op'>]</span>
  
  <span class='co'># West</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>W</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>W</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='co'># how far in each direction to edge of matrix</span>
  <span class='va'>to_N</span> <span class='op'>&lt;-</span> <span class='va'>i</span> <span class='op'>-</span> <span class='fl'>1</span>
  <span class='va'>to_S</span> <span class='op'>&lt;-</span> <span class='va'>nr</span> <span class='op'>-</span> <span class='va'>i</span>
  <span class='va'>to_E</span> <span class='op'>&lt;-</span> <span class='va'>nc</span> <span class='op'>-</span> <span class='va'>j</span>
  <span class='va'>to_W</span> <span class='op'>&lt;-</span> <span class='va'>j</span> <span class='op'>-</span> <span class='fl'>1</span>
  
  <span class='co'># North-West</span>
  <span class='va'>NW_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>to_N</span>, <span class='va'>to_W</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>NW</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>mat_index</span> <span class='op'>&lt;-</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='va'>NW_length</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='va'>NW_length</span><span class='op'>)</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>NW</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>mat_index</span><span class='op'>]</span>
  <span class='op'>}</span>
  
  <span class='co'># North-East</span>
  <span class='va'>NE_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>to_N</span>, <span class='va'>to_E</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='va'>NE</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>mat_index</span> <span class='op'>&lt;-</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>-</span><span class='va'>NE_length</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='va'>NE_length</span><span class='op'>)</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>NE</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>mat_index</span><span class='op'>]</span>
  <span class='op'>}</span>
  
  <span class='co'># South-East</span>
  <span class='va'>SE_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>to_S</span>, <span class='va'>to_E</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span> <span class='op'>|</span> <span class='va'>j</span> <span class='op'>==</span> <span class='va'>nc</span><span class='op'>)</span> <span class='va'>SE</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>mat_index</span> <span class='op'>&lt;-</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='va'>SE_length</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>+</span><span class='va'>SE_length</span><span class='op'>)</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>SE</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>mat_index</span><span class='op'>]</span>
  <span class='op'>}</span>
  
  <span class='co'># South-West</span>
  <span class='va'>SW_length</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>to_S</span>, <span class='va'>to_W</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span> <span class='op'>==</span> <span class='va'>nr</span> <span class='op'>|</span> <span class='va'>j</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='va'>SW</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
  <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>mat_index</span> <span class='op'>&lt;-</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>i</span><span class='op'>+</span><span class='va'>SW_length</span><span class='op'>)</span>, <span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>j</span><span class='op'>-</span><span class='va'>SW_length</span><span class='op'>)</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
    <span class='va'>SW</span> <span class='op'>&lt;-</span> <span class='va'>mat</span><span class='op'>[</span><span class='va'>mat_index</span><span class='op'>]</span>
  <span class='op'>}</span>

  <span class='co'># vectors from mat[i,j] to the edge in each direction </span>
  <span class='va'>all_vecs</span> <span class='op'>&lt;-</span> 
    <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>N <span class='op'>=</span> <span class='va'>N</span>, S <span class='op'>=</span> <span class='va'>S</span>, E <span class='op'>=</span> <span class='va'>E</span>, W <span class='op'>=</span> <span class='va'>W</span>, NW <span class='op'>=</span> <span class='va'>NW</span>, NE <span class='op'>=</span> <span class='va'>NE</span>, SE <span class='op'>=</span> <span class='va'>SE</span>, SW <span class='op'>=</span> <span class='va'>SW</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># the first seat in each direction, collapsed to a vector</span>
  <span class='va'>first_seats</span> <span class='op'>&lt;-</span> <span class='fu'>purrr</span><span class='fu'>::</span><span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map_chr</a></span><span class='op'>(</span><span class='va'>all_vecs</span>, <span class='va'>get_first_seat_from_vec</span><span class='op'>)</span>
  
  <span class='co'># remove NAs from list and return</span>
  <span class='co'># (these occur either when starting on an edge, </span>
  <span class='co'># or when there are no seats in a given direction)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>first_seats</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>first_seats</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>layout</span> <span class='op'>&lt;-</span> <span class='va'>initial_layout</span>
<span class='va'>iters</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>

<span class='co'># loop until there are no further changes</span>
<span class='kw'>repeat</span> <span class='op'>{</span>
  
  <span class='va'>change</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  
  <span class='va'>seats_to_change</span> <span class='op'>&lt;-</span> 
    <span class='va'>seats_df</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>change_seat <span class='op'>=</span> <span class='fu'>needs_changing</span><span class='op'>(</span><span class='va'>layout</span>,<span class='va'>i</span>,<span class='va'>j</span>, <span class='va'>get_first_seat</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>   
  
  <span class='va'>change</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>seats_to_change</span><span class='op'>$</span><span class='va'>change_seat</span><span class='op'>)</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>change</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span> <span class='kw'>break</span>
  
  <span class='va'>indices_to_change</span> <span class='op'>&lt;-</span> 
    <span class='va'>seats_to_change</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>change_seat</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='va'>j</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span>  

  <span class='va'>layout</span><span class='op'>[</span><span class='va'>indices_to_change</span><span class='op'>]</span> <span class='op'>&lt;-</span> 
    <span class='fu'><a href='https://generics.r-lib.org/reference/setops.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"L"</span>, <span class='st'>"#"</span><span class='op'>)</span>,  <span class='va'>layout</span><span class='op'>[</span><span class='va'>indices_to_change</span><span class='op'>]</span><span class='op'>)</span>
  
  <span class='va'>iters</span> <span class='op'>&lt;-</span> <span class='va'>iters</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='op'>}</span>

<span class='va'>part_2_iters</span> <span class='op'>&lt;-</span> <span class='va'>iters</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>layout</span><span class='op'>==</span> <span class='st'>"#"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 26</code></pre>
</div>
<p>On the test set, this takes 6 iterations. On the full data set, my answer is 2128, and it took 87 iterations. Given this is fewer iterations than in Part 1, it must be my code for getting the first seat that’s slowing things down.</p>
<p>I am unsatisfied both by how many lines of code this has taken as well as the time taken to run. The introduction to Advent of Code says that each challenge has a solution that will complete in at most 15 seconds on ten year old hardware. So clearly there’s a better way of doing this. Perhaps something to revisit in the future.</p>
<h2 id="next">Next</h2>
<p>I was late to the game, and that was as far as I managed to get in December 2020. I’m looking forward to taking on the challenge again in 2021!</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/EllaKaye/ellakaye-distill/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. Source code is available at <a href="https://github.com/EllaKaye/ellakaye-distill">https://github.com/EllaKaye/ellakaye-distill</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Kaye (2020, Dec. 9). ELLA KAYE: Advent of Code 2020. Retrieved from https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{kaye2020advent,
  author = {Kaye, Ella},
  title = {ELLA KAYE: Advent of Code 2020},
  url = {https://ellakaye.rbind.io/posts/2020-12-09-advent-of-code-2020/},
  year = {2020}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
